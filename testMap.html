<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <!-- Nous chargeons les fichiers CDN de Leaflet. Le CSS AVANT le JS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css" integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ==" crossorigin="" />
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.css" />
    <link rel="stylesheet" type="text/css" href="https://unpkg.com/leaflet.markercluster@1.3.0/dist/MarkerCluster.Default.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.css" />
    <link href='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/leaflet.fullscreen.css' rel='stylesheet' />

    
    <style type="text/css">
        #map {
            /* la carte DOIT avoir une hauteur sinon elle n'appara√Æt pas */
            height: 300px;
            width: 400px;
        }
    </style>
    <title>Carte</title>
    <!-- Fichiers Javascript -->
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js" integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw==" crossorigin=""></script>
    <script type='text/javascript' src='https://unpkg.com/leaflet.markercluster@1.3.0/dist/leaflet.markercluster.js'></script>
    <script src="https://unpkg.com/leaflet-control-geocoder/dist/Control.Geocoder.js"></script>
    <script src="JS/geoPosition.js"></script>
    <script src='https://api.mapbox.com/mapbox.js/plugins/leaflet-fullscreen/v1.0.1/Leaflet.fullscreen.min.js'></script>

    <script type="text/javascript">
        var tabCdpLatLon = [];
        window.onload = function() {

            x_return_all_lat_lon_cdp(display_latLonCdp);

            console.log(lat, lon);
            initMap();

            tabVal[0]['cdp']='44600';
            tabVal[1]['cdp']='65400';
            tabVal[2]['cdp']='56000';
				var lat = 0;
				var lon = 0;
				if (tabCdpLatLon[tabVal[i]['cdp']]) {
					console.log(tabCdpLatLon[tabVal[i]['cdp']]);
					var tabTmp = tabCdpLatLon[tabVal[i]['cdp']].split(',');
					var lat = tabTmp[0];
					var lon = tabTmp[1];
					addMarker(lat, lon, tabVal[i]['cdp']);
				} else {
					setTimeout('geoPosClient(' + tabVal[i]['cdp'] + ')', TIME_PAUSE * indexSearch);
					// setTimeout('addMarkerdecal(' + tabVal[i]['cdp'] + ',' + indexSearch + ')', TIME_PAUSE * indexSearch + 200);
					indexSearch++;
				}
        };

        
	function display_latLonCdp(val) {
		console.log(val);
		for (var cdp in val) {
			tabCdpLatLon[cdp] = val[cdp];
		}
		console.log(tabCdpLatLon);
	}
    </script>
</head>

<body>
    <div id="map">
        <!-- Ici s'affichera la carte -->
    </div>

</body>

</html>