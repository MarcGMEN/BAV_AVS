<?php

/*
 * retourne un user pour un id
 */
function return_articles($idRub="") {
  $row=null;
  $tabReturn=array();
  $requete = "select *, rub_libelle, usr_nom ";
  $requete .= " from ".CFG_PREFIXE_TABLE."actus, ".CFG_PREFIXE_TABLE."rubrique, ".CFG_PREFIXE_TABLE."user ";
  $requete .= " where act_rub_id =rub_id " ;
  $requete .= " and act_usr_id =usr_id " ;
  $requete .= " and act_type= 'article' " ;
  if (isset($idRub) && strlen(trim($idRub)) > 0) {
    $requete .= " and (rub_id = ".$idRub;
    $requete .= " or rub_id_rub = ".$idRub.")";
  }
  $requete .= "order by act_date_modification desc, act_date desc,act_rub_id ";
  //echo $requete;
  if (!$resultat = mysql_query($requete)) {
    echo "erreur sur $requete ";
  }

  $i=0;
  while ($row = mysql_fetch_array($resultat, MYSQL_ASSOC)) {
    $tabReturn[$row['act_id']] = $row;
  }

  return  $tabReturn;
}

function return_article($id) {
  $row=null;
  $requete = "select *, rub_libelle, usr_nom  ";
  $requete .= " from ".CFG_PREFIXE_TABLE."actus, ".CFG_PREFIXE_TABLE."rubrique, ".CFG_PREFIXE_TABLE."user ";
  $requete .= " where act_id =  ".$id;
  $requete .= " and act_rub_id =rub_id " ;
  $requete .= " and act_usr_id =usr_id " ;
  $requete .= " and act_type= 'article' " ;
  //echo $requete;
  $resultat = mysql_query($requete);

  if (!$row = mysql_fetch_array($resultat, MYSQL_ASSOC) ) {
    echo "erreur sur $requete ".mysql_error()."<br/>";
  }

  return  $row;
}
?>